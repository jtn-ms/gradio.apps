```sh
$ msfconsole
Metasploit tip: Tired of setting RHOSTS for modules? Try globally setting it 
with setg RHOSTS x.x.x.x

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%
%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%
%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%
%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%
%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


       =[ metasploit v6.3.37-dev-                         ]
+ -- --=[ 2364 exploits - 1228 auxiliary - 413 post       ]
+ -- --=[ 1388 payloads - 46 encoders - 11 nops           ]
+ -- --=[ 9 evasion                                       ]

Metasploit Documentation: https://docs.metasploit.com/



msf6> use auxiliary/scanner/smb/smb_ms17_010
msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOSTS 192.168.0.6
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[-] 192.168.0.6:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[*] 192.168.0.6:445       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

```sh
# https://github.com/rapid7/metasploit-framework/issues/11691

# Ok so if anyone is still facing the error: (Tested on Windows server 2012 r2)
# -First run this script on the target machine to know whether it is vulnerable to eternalblue
# If the machine is not vulnerable, then it is patched, therefore remove all windows KB update/patch superior to '401..'
#  > wusa /uninstall /kb:5003209
# -Next if the script says that the machine is vulnerable but you still facing this issue, then open group policy editor
# > gpedit.msc
# Go to Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options
# edit 'Network access: Shares that can be accessed anonymously' and add " \ " to the empty list
```

```sh
msf6 auxiliary(scanner/smb/smb_ms17_010) > show options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting    Required  Description
   ----         ---------------    --------  -----------
   CHECK_ARCH   true               no        Check for architecture on v  
                                             ulnerable hosts
   CHECK_DOPU   true               no        Check for DOUBLEPULSAR on v  
                                             ulnerable hosts
   CHECK_PIPE   false              no        Check for named pipe on vul  
                                             nerable hosts
   NAMED_PIPES  /opt/metasploit-f  yes       List of named pipes to chec  
                ramework/embedded            k
                /framework/data/w
                ordlists/named_pi
                pes.txt
   RHOSTS       192.168.0.6        yes       The target host(s), see htt  
                                             ps://docs.metasploit.com/do  
                                             cs/using-metasploit/basics/  
                                             using-metasploit.html        
   RPORT        445                yes       The SMB service port (TCP)   
   SMBDomain    .                  no        The Windows domain to use f  
                                             or authentication
   SMBPass                         no        The password for the specif  
                                             ied username
   SMBUser                         no        The username to authenticat  
                                             e as
   THREADS      1                  yes       The number of concurrent th  
                                             reads (max one per host)     


View the full module info with the info, or info -d command.
```

```sh

```

## how to check if my windows server is secure using automatic test with metasploit. any simple way - one command or so

Metasploit provides a set of security assessment and penetration testing tools that can be used to check the security of a Windows server. While Metasploit is a powerful framework, it's important to note that using it to automatically test your own systems without proper authorization is unethical and potentially illegal. Therefore, you should only use Metasploit to test systems that you have explicit permission to assess.

Here's a simplified example of how you can use Metasploit to perform a basic vulnerability assessment on your Windows server:

Note: Replace <target_ip> with the IP address of your Windows server.

Open Metasploit Framework:

Start by opening Metasploit. Depending on your installation, you can typically run it by executing the msfconsole command.

Search for Vulnerability Scanning Modules:

Use the search command to search for available vulnerability scanning modules. These modules are used to check for known vulnerabilities on a target system. For example:

```sh
search vulnerability
```

Select and Configure a Module:

Choose a vulnerability scanning module that suits your needs. For example, you can use the auxiliary/scanner/smb/smb_ms17_010 module to check for the MS17-010 vulnerability (EternalBlue) that affected Windows systems.

```sh
use auxiliary/scanner/smb/smb_ms17_010
```

Set the Target IP Address:

Set the RHOSTS option to the IP address of your Windows server:
```sh
set RHOSTS <target_ip>
```
Run the Module:

Execute the module by running the exploit command:

```sh
exploit
```

The module will attempt to check if the MS17-010 vulnerability exists on the target system.

Review the Results:

Metasploit will display the results of the vulnerability scan. It will indicate whether the target is vulnerable or not.

Please note that this is just a simple example, and Metasploit offers a wide range of modules for various security assessments and penetration testing tasks. Additionally, Metasploit should be used responsibly, and you should always have proper authorization to perform any testing on systems you don't own.

It's important to mention that vulnerability scanning should be part of a broader security assessment strategy, which may include manual testing, patch management, and other security measures.
