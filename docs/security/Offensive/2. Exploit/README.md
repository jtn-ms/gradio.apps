## Categories

- vulnerability2payload

## Tools

- [metasploit]
- [searchsploit](https://gitlab.com/exploit-database/exploitdb)
- [findsploit]
- [websploit]

## Targets

### [msrpc, 135](https://exploit-notes.hdks.org/exploit/windows/protocol/msrpc-pentesting/)

```sh
eval target_ip=192.168.0.14

nmap --script msrpc-enum -p 135 ${target_ip}

# rpcdump for dumping RPC endpoints
impacket-rpcdump -port 135 ${target_ip}
# Find the Print System Remote Prototol or the Print System Asynchronous Remote Protocol
impacket-rpcdump -port 135 ${target_ip} | grep -E 'MS-RPRN|MS-PAR'

msfconsole
msf> use auxiliary/scanner/dcerpc/endpoint_mapper
msf> use auxiliary/scanner/dcerpc/hidden
msf> use auxiliary/scanner/dcerpc/management
msf> use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor


rpcinfo -p ${target_ip}

# NFS only
rpcinfo -p ${target_ip} | grep nfs

# Anonymous logon
rpcclient -N -U "" ${target_ip}
rpcclient -N -U "" -p 593 ${target_ip}
rpcclient -N -U "" dc.example.local

# Specify username
# -W: Workgroup
# -N: No password
rpcclient -U username ${target_ip}
rpcclient -W WORKGROUP -U username ${target_ip}
rpcclient -U username -N ${target_ip}

# -k: Kerberos
rpcclient -k ${target_ip}


# Server info
rpcclient $> srvinfo

# Enumerate domains
rpcclient $> enumdomains
# Enumerate domain users
rpcclient $> enumdomusers
# Enumerate domain groups
rpcclient $> enumdomgroups

# Domain info
rpcclient $> querydominfo

# Current username
rpcclient $> getusername
```